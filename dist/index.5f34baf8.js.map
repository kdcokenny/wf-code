{"mappings":"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","sources":["src/js/functions/sse.js","src/js/user_data.js","src/js/create_chat_completion.js","src/js/functions/get.js","src/js/sort_templates.js","src/js/copyClearInput.js"],"sourcesContent":["export function SSE (url, options) {\n    if (!(this instanceof SSE)) {\n        return new SSE(url, options);\n    }\n\n    this.INITIALIZING = -1;\n    this.CONNECTING = 0;\n    this.OPEN = 1;\n    this.CLOSED = 2;\n\n    this.url = url;\n\n    options = options || {};\n    this.headers = options.headers || {};\n    this.payload = options.payload !== undefined ? options.payload : '';\n    this.method = options.method || (this.payload && 'POST' || 'GET');\n    this.withCredentials = !!options.withCredentials;\n\n    this.FIELD_SEPARATOR = ':';\n    this.listeners = {};\n\n    this.xhr = null;\n    this.readyState = this.INITIALIZING;\n    this.progress = 0;\n    this.chunk = '';\n\n    this.addEventListener = function (type, listener) {\n        if (this.listeners[type] === undefined) {\n            this.listeners[type] = [];\n        }\n\n        if (this.listeners[type].indexOf(listener) === -1) {\n            this.listeners[type].push(listener);\n        }\n    };\n\n    this.removeEventListener = function (type, listener) {\n        if (this.listeners[type] === undefined) {\n            return;\n        }\n\n        var filtered = [];\n        this.listeners[type].forEach(function (element) {\n            if (element !== listener) {\n                filtered.push(element);\n            }\n        });\n        if (filtered.length === 0) {\n            delete this.listeners[type];\n        } else {\n            this.listeners[type] = filtered;\n        }\n    };\n\n    this.dispatchEvent = function (e) {\n        if (!e) {\n            return true;\n        }\n\n        e.source = this;\n\n        var onHandler = 'on' + e.type;\n        if (this.hasOwnProperty(onHandler)) {\n            this[onHandler].call(this, e);\n            if (e.defaultPrevented) {\n                return false;\n            }\n        }\n\n        if (this.listeners[e.type]) {\n            return this.listeners[e.type].every(function (callback) {\n                callback(e);\n                return !e.defaultPrevented;\n            });\n        }\n\n        return true;\n    };\n\n    this._setReadyState = function (state) {\n        var event = new CustomEvent('readystatechange');\n        event.readyState = state;\n        this.readyState = state;\n        this.dispatchEvent(event);\n    };\n\n    this._onStreamFailure = function (e) {\n        var event = new CustomEvent('error');\n        event.data = e.currentTarget.response;\n        this.dispatchEvent(event);\n        this.close();\n    }\n\n    this._onStreamAbort = function (e) {\n        this.dispatchEvent(new CustomEvent('abort'));\n        this.close();\n    }\n\n    this._onStreamProgress = function (e) {\n        if (!this.xhr) {\n            return;\n        }\n\n        if (this.xhr.status !== 200) {\n            this._onStreamFailure(e);\n            return;\n        }\n\n        if (this.readyState == this.CONNECTING) {\n            this.dispatchEvent(new CustomEvent('open'));\n            this._setReadyState(this.OPEN);\n        }\n\n        var data = this.xhr.responseText.substring(this.progress);\n        this.progress += data.length;\n        data.split(/(\\r\\n|\\r|\\n){2}/g).forEach(function (part) {\n            if (part.trim().length === 0) {\n                this.dispatchEvent(this._parseEventChunk(this.chunk.trim()));\n                this.chunk = '';\n            } else {\n                this.chunk += part;\n            }\n        }.bind(this));\n    };\n\n    this._onStreamLoaded = function (e) {\n        this._onStreamProgress(e);\n\n        // Parse the last chunk.\n        this.dispatchEvent(this._parseEventChunk(this.chunk));\n        this.chunk = '';\n    };\n\n    /**\n     * Parse a received SSE event chunk into a constructed event object.\n     */\n    this._parseEventChunk = function (chunk) {\n        if (!chunk || chunk.length === 0) {\n            return null;\n        }\n\n        var e = { 'id': null, 'retry': null, 'data': '', 'event': 'message' };\n        chunk.split(/\\n|\\r\\n|\\r/).forEach(function (line) {\n            line = line.trimRight();\n            var index = line.indexOf(this.FIELD_SEPARATOR);\n            if (index <= 0) {\n                // Line was either empty, or started with a separator and is a comment.\n                // Either way, ignore.\n                return;\n            }\n\n            var field = line.substring(0, index);\n            if (!(field in e)) {\n                return;\n            }\n\n            var value = line.substring(index + 1).trimLeft();\n            if (field === 'data') {\n                e[field] += value;\n            } else {\n                e[field] = value;\n            }\n        }.bind(this));\n\n        var event = new CustomEvent(e.event);\n        event.data = e.data;\n        event.id = e.id;\n        return event;\n    };\n\n    this._checkStreamClosed = function () {\n        if (!this.xhr) {\n            return;\n        }\n\n        if (this.xhr.readyState === XMLHttpRequest.DONE) {\n            this._setReadyState(this.CLOSED);\n        }\n    };\n\n    this.stream = function () {\n        this._setReadyState(this.CONNECTING);\n\n        this.xhr = new XMLHttpRequest();\n        this.xhr.addEventListener('progress', this._onStreamProgress.bind(this));\n        this.xhr.addEventListener('load', this._onStreamLoaded.bind(this));\n        this.xhr.addEventListener('readystatechange', this._checkStreamClosed.bind(this));\n        this.xhr.addEventListener('error', this._onStreamFailure.bind(this));\n        this.xhr.addEventListener('abort', this._onStreamAbort.bind(this));\n        this.xhr.open(this.method, this.url);\n        for (var header in this.headers) {\n            this.xhr.setRequestHeader(header, this.headers[header]);\n        }\n        this.xhr.withCredentials = this.withCredentials;\n        this.xhr.send(this.payload);\n    };\n\n    this.close = function () {\n        if (this.readyState === this.CLOSED) {\n            return;\n        }\n\n        this.xhr.abort();\n        this.xhr = null;\n        this._setReadyState(this.CLOSED);\n    };\n};\n\n// Export our SSE module for npm.js\nif (typeof exports !== 'undefined') {\n    exports.SSE = SSE;\n}","// Define a function to wait until isRequesting is false\nasync function waitForIsRequesting() {\n    return new Promise(resolve => {\n      const checkIsRequesting = async () => {\n        if (!(await Wized.data.get(\"r.3.$.isRequesting\"))) {\n          resolve();\n        } else {\n          setTimeout(checkIsRequesting, 10);\n        }\n      };\n  \n      checkIsRequesting();\n    });\n  }\n  \n  // Define a function to update the display based on user data\n  function updateDisplay(loadUser) {\n    const accountButton = document.getElementById(\"account-button\");\n    const signInButton = document.getElementById(\"generatebutton_signin\");\n    const generateButton = document.getElementById(\"generatebutton\");\n    const templateFunctional = document.getElementById(\"template_functional\");\n    const templateSignIn = document.getElementById(\"template_signin\");\n    const dashboardSignIn = document.getElementById(\"dashboard-sign-in\");\n  \n    if (loadUser.statusCode === 200) {\n      accountButton.style.display = \"flex\";\n      signInButton.style.display = \"none\";\n      generateButton.style.display = \"block\";\n      templateFunctional.style.display = \"flex\";\n      templateSignIn.style.display = \"none\";\n      dashboardSignIn.style.display = \"none\";\n    } else {\n      accountButton.style.display = \"none\";\n      signInButton.style.display = \"block\";\n      generateButton.style.display = \"none\";\n      templateFunctional.style.display = \"none\";\n      templateSignIn.style.display = \"flex\";\n      dashboardSignIn.style.display = \"flex\";\n    }\n  }\n  \n  // Define a function to load the user data and show/hide elements\n  async function loadData() {\n    try {\n      await waitForIsRequesting();\n  \n      const loadUser = await Wized.data.get(\"r.3.$\");\n  \n      updateDisplay(loadUser);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  \n  document.addEventListener(\"DOMContentLoaded\", () => {\n    if (typeof Wized !== \"undefined\" && typeof Wized.data !== \"undefined\" && typeof document !== \"undefined\") {\n      loadData();\n    } else {\n      console.error(\"Wized or document not available.\");\n    }\n  });\n  ","import { SSE } from './functions/sse';\nimport { get } from './functions/get';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const elements = {\n    generateButton: document.getElementById('generatebutton'),\n    promptInput: document.getElementById('prompt_input'),\n    streamedOutput: document.getElementById('streamedOutput'),\n    loadingAnimation: document.getElementById('enter-loading-lottie'),\n    outputButtons: document.getElementById('output_buttons'),\n  };\n\n  const state = {\n    isSseRequested: false,\n    outputText: '',\n    lastRequestTime: 0,\n  };\n\n  elements.promptInput.addEventListener('keydown', handlePromptInputKeyDown);\n  elements.generateButton.addEventListener('click', handleGenerateButtonClick);\n\n  async function handleGenerateButtonClick() {\n    const { active } = await fetchData();\n    if (state.isSseRequested || !canRequest(active)) {\n      const remainingTime = 30 - Math.floor(hasReachedCooldown() / 1000);\n      if (remainingTime > 0) {\n        showRemainingTimeMessage(remainingTime);\n        clearStreamedOutputText();\n        await toggleView(2);\n      }\n      return;\n    }\n    state.isSseRequested = true;\n\n    await clearStreamedOutputText();\n    await incrementRequestCount();\n    await toggleView(2);\n    toggleGenerateButton(false);\n    toggleLoadingAnimation(true);\n\n    const statusCode = await triggerLoadUserRequest();\n    if (statusCode === 200) {\n      const { active, template } = await fetchData();\n      if (active || hasReachedCooldown()) {\n        const body = buildRequestBody(template);\n        const sse = createSseObject(body);\n        sse.addEventListener('message', handleSseMessageEvent);\n        sse.stream();\n        state.lastRequestTime = Date.now();\n      } else {\n        handleNoCharactersAvailable();\n      }\n    } else {\n      console.log('Error: status code is not 200');\n    }\n  }\n\n  async function triggerLoadUserRequest() {\n    await Wized.request.execute('Load user');\n    return await Wized.data.get('r.3.$.statusCode');\n  }\n\n  function handlePromptInputKeyDown(event) {\n    if (event.key === 'Enter' && !event.shiftKey && !state.isSseRequested) {\n      event.preventDefault();\n      elements.generateButton.click();\n    }\n  }\n\n  function handleSseMessageEvent(event) {\n    const msg = event.data;\n    if (msg === '[DONE]') {\n      setOutputVar();\n      handleSseRequestDone();\n      return;\n    }\n    const data = JSON.parse(msg);\n    const text = get(data.choices[0].delta, 'content', '');\n    state.outputText += text;\n    appendStreamedOutputText(text);\n  }\n\n  function createSseObject(body) {\n    return new SSE('https://scholarly-main-bd50e2e.zuplo.app/v1/post-stream', {\n      headers: {\n        'content-type': 'application/json',\n      },\n      payload: JSON.stringify(body),\n      method: 'POST',\n    });\n  }\n\n  async function toggleView(view) {\n    await Wized.data.setVariable('view', view);\n  }\n\n  function toggleGenerateButton(visible) {\n    elements.generateButton.style.display = visible ? 'block' : 'none';\n  }\n\n  function toggleLoadingAnimation(visible) {\n    elements.loadingAnimation.style.display = visible ? 'block' : 'none';\n    elements.outputButtons.style.display = visible ? 'none' : 'flex';\n  }\n\n  async function setOutputVar() {\n    await Wized.data.setVariable('textoutput', state.outputText.trim());\n  }\n\n  function handleSseRequestDone() {\n    state.isSseRequested = false;\n    toggleGenerateButton(true);\n    toggleLoadingAnimation(false);\n  }\n  async function clearStreamedOutputText() {\n    await resetCopyVar();\n    elements.streamedOutput.innerHTML = '';\n  }\n\n  function appendStreamedOutputText(text) {\n    const textWithLineBreaks = text.replace(/\\n/g, '<br>');\n    const isFirstText = elements.streamedOutput.innerHTML === '';\n    const textToAdd = isFirstText\n      ? text.replace(/^\\n/, '')\n      : textWithLineBreaks;\n    elements.streamedOutput.innerHTML += textToAdd;\n  }\n\n  async function fetchData() {\n    const active = await Wized.data.get('v.activeplan');\n    const template = await Wized.data.get('v.selectedtemplate');\n    return { active, template };\n  }\n\n  function buildRequestBody(template) {\n    const inputVal = elements.promptInput.value;\n    const contextInput = document.getElementById('context_input');\n    const toneInput = document.getElementById('selector_input_tone');\n    const styleInput = document.getElementById('selector_input_style');\n    let content = template !== 0 ? template.completion.prompt : '[INPUT]';\n    content = content.replace(/\\[INPUT\\]/g, inputVal);\n    content = addContext(content, contextInput.value);\n    content = addToneAndStyle(content, toneInput.value, styleInput.value);\n\n    const body = {\n      model: 'gpt-4',\n      messages: [{ role: 'user', content }],\n      stream: true,\n    };\n\n    if (template !== 0) {\n      Object.assign(body, {\n        temperature: template.completion.temperature,\n        top_p: template.completion.top_p,\n        n: template.completion.n,\n        presence_penalty: template.completion.presence_penalty,\n        frequency_penalty: template.completion.frequency_penalty,\n      });\n    }\n\n    return body;\n  }\n\n  function addContext(content, context) {\n    if (context !== '') {\n      content = `Using this context: ${context}.\\n\\n${content}`;\n    }\n    return content;\n  }\n\n  function addToneAndStyle(content, tone, style) {\n    if (tone || style) {\n      content += '\\n\\n';\n      if (tone) content += `Write in this tone: ${tone}.`;\n      if (style)\n        content += `The output should use this writing style: ${style}.`;\n    }\n    return content;\n  }\n\n  function canRequest(active) {\n    const cooldown = 30 * 1000;\n    const currentTime = Date.now();\n\n    return active || currentTime - state.lastRequestTime >= cooldown;\n  }\n\n  function hasReachedCooldown() {\n    const cooldown = 30 * 1000;\n    const currentTime = Date.now();\n\n    return currentTime - state.lastRequestTime;\n  }\n\n  function showRemainingTimeMessage(remainingTime) {\n    updateRemainingTimeMessage(remainingTime);\n    const countdownInterval = setInterval(async () => {\n      remainingTime--;\n      if (remainingTime <= 0) {\n        clearInterval(countdownInterval);\n        await toggleView(1);\n        clearStreamedOutputText();\n      } else {\n        updateRemainingTimeMessage(remainingTime);\n      }\n    }, 1000);\n  }\n\n  function updateRemainingTimeMessage(remainingTime) {\n    const message = `Please wait ${remainingTime} seconds before the next request, or upgrade now to remove all restrictions.`;\n    elements.streamedOutput.innerHTML = message;\n  }\n\n  async function incrementRequestCount() {\n    await Wized.request.execute('Increment Req');\n  }\n\n  async function resetCopyVar() {\n    await Wized.data.setVariable('textoutput', '');\n    state.outputText = ''; // Reset the state.outputText variable\n  }\n});\n","export function get(object, key, default_value) {\n    var result = object[key];\n    return (typeof result !== \"undefined\") ? result : default_value;\n}","window.onload = async () => {\n    let startIndex = 0;\n    const [prev, next, searchInput, selectSubject] = [\"prev_button\", \"next_button\", \"template_search\", \"select_subject\"].map(id => document.getElementById(id));\n    let totalLength;\n\n    await Wized.request.execute(\"Get templates\");\n    const data = await Wized.data.get(\"r.59.d\");\n    let filteredData = data || [];\n\n    const filterTemplates = async (searchQuery = \"\") => {\n        filteredData = data?.filter(template => {\n            const group = template.group || [];\n            const selectedSubject = selectSubject.value;\n            const shouldShow = !selectedSubject || group.includes(selectedSubject);\n            return shouldShow && template.show && template.header?.toLowerCase().startsWith(searchQuery.toLowerCase());\n        }) || [];\n        totalLength = filteredData.length;\n        document.getElementById(\"total_templates_text\").textContent = totalLength;\n        document.getElementById(\"template_min_text\").textContent = startIndex + 1;\n        document.getElementById(\"template_max_text\").textContent = Math.min(startIndex + 12, totalLength);\n        const filteredTemplates = filteredData.slice(startIndex, startIndex + 12);\n        await Wized.data.setVariable(\"template\", filteredTemplates);\n    };\n\n    const updateTemplates = async (increment) => {\n        startIndex += increment;\n        await filterTemplates(searchInput.value);\n    };\n\n    next.addEventListener(\"click\", async () => {\n        if (startIndex + 12 < totalLength) await updateTemplates(12);\n    });\n\n    prev.addEventListener(\"click\", async () => {\n        if (startIndex > 0) await updateTemplates(-12);\n    });\n\n    searchInput.addEventListener(\"input\", async () => {\n        startIndex = 0;\n        await filterTemplates(searchInput.value);\n    });\n\n    selectSubject.addEventListener(\"change\", async () => {\n        startIndex = 0;\n        await filterTemplates(searchInput.value);\n    });\n\n    await filterTemplates();\n};","document.addEventListener(\"DOMContentLoaded\", function () {\n    const newButton = document.getElementById(\"new_button\");\n    const promptInput = document.getElementById(\"prompt_input\");\n    const copyButton = document.getElementById(\"copy_button\");\n    const streamedOutput = document.getElementById(\"streamedOutput\");\n\n    newButton.addEventListener(\"click\", function () {\n        promptInput.value = \"\";\n    });\n\n    copyButton.addEventListener(\"click\", async function () {\n        const textArea = document.createElement('textarea');\n        textArea.value = await Wized.data.get(\"v.textoutput\");\n        document.body.appendChild(textArea);\n        textArea.select();\n        document.execCommand('copy');\n        textArea.remove();\n        alert('Text copied to clipboard!');\n    });\n});\n"],"names":["$1e25f411bbf11903$export$e378e72244b21993","url","options","this","INITIALIZING","CONNECTING","OPEN","CLOSED","headers","payload","undefined","method","withCredentials","FIELD_SEPARATOR","listeners","xhr","readyState","progress","chunk","addEventListener","type","listener","indexOf","push","removeEventListener","filtered","forEach","element","length","dispatchEvent","e","source","onHandler","hasOwnProperty","call","defaultPrevented","every","callback","_setReadyState","state","event","CustomEvent","_onStreamFailure","data","currentTarget","response","close","_onStreamAbort","_onStreamProgress","status","responseText","substring","split","part","trim","_parseEventChunk","bind","_onStreamLoaded","id","retry","line","index","trimRight","field","value","trimLeft","_checkStreamClosed","XMLHttpRequest","DONE","stream","header","open","setRequestHeader","send","abort","async","$46f7f455d5577b7b$var$loadData","Promise","resolve","checkIsRequesting","Wized","get","setTimeout","$46f7f455d5577b7b$var$waitForIsRequesting","loadUser","accountButton","document","getElementById","signInButton","generateButton","templateFunctional","templateSignIn","dashboardSignIn","statusCode","style","display","$46f7f455d5577b7b$var$updateDisplay","error","console","elements","promptInput","streamedOutput","loadingAnimation","outputButtons","isSseRequested","outputText","lastRequestTime","handleSseMessageEvent","msg","setVariable","setOutputVar","toggleGenerateButton","toggleLoadingAnimation","JSON","parse","text","object","choices","delta","default_value","result","textWithLineBreaks","replace","textToAdd","innerHTML","appendStreamedOutputText","toggleView","view","visible","clearStreamedOutputText","resetCopyVar","fetchData","hasReachedCooldown","Date","now","updateRemainingTimeMessage","remainingTime","message","key","shiftKey","preventDefault","click","active","cooldown","currentTime","canRequest","Math","floor","countdownInterval","setInterval","clearInterval","showRemainingTimeMessage","request","execute","incrementRequestCount","triggerLoadUserRequest","template","body","inputVal","contextInput","toneInput","styleInput","content","completion","prompt","context","addContext","tone","addToneAndStyle","model","messages","role","Object","assign","temperature","top_p","n","presence_penalty","frequency_penalty","buildRequestBody","sse","stringify","createSseObject","handleNoCharactersAvailable","log","window","onload","startIndex","prev","next","searchInput","selectSubject","map","totalLength","filteredData","filterTemplates","searchQuery","filter","group","selectedSubject","includes","show","toLowerCase","startsWith","textContent","min","filteredTemplates","slice","updateTemplates","increment","newButton","copyButton","textArea","createElement","appendChild","select","execCommand","remove","alert"],"version":3,"file":"index.5f34baf8.js.map"}